#!/usr/bin/env ruby
require 'slop'

require_relative '../lib/movienga/cinemas/netflix'
require_relative '../lib/movienga/version'

def parse_arguments
  Slop.parse do |o|
    o.string '--pay', 'Put cash to account'
    o.string '--show', 'Select movie with filter', required: true
    o.string '--data', 'Path to data file', required: true
    o.on '--version', 'print the version' do
      puts Movienga::VERSION
      exit
    end
  end
rescue Exception => e
  puts e.message
  exit
end

opts = parse_arguments

netflix = Movienga::Netflix.new(opts[:data])

if opts[:pay]
  netflix.pay opts[:pay]
end

param, query = opts[:show].split(':')
netflix.show param.to_sym => query
